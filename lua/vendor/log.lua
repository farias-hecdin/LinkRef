local a={name='vlog',clog=true,hls=true,ufle=true,lv="trace",mod={{name="trace",hl="Comment"},{name="info",hl="None"}},float=0.01}local b,c,d,e,f,g,h={},string.format,os.date,io.open,debug.getinfo,table.concat,vim.fn;local h,i,j,k,l=vim.cmd,vim.inspect,vim.tbl_deep_extend,h.stdpath,h.escape;local function m(a,b)return#a>b and"..."..a:sub(#a-b)or a end;b.new=function(n,o)n=j("force",a,n)local a,j=n.name,ipairs;local k=c('%s/%s.log',k('data'),a)local b=o and b or{}local o={}for a,b in j(n.mod)do o[b.name]=a;b.upper=b.name:upper()end;local function p(...)local a,b,d,e,f={},n.float,tostring,type,select;for g=1,f('#',...)do local f=f(g,...)f=e(f)=="number"and b and c("%."..toString(b):match("%d+").."f",f)or e(f)=="table"and i(f)or d(f)a[#a+1]=f end;return g(a," ")end;local function g(b,g,i,...)if b<o[n.lv]then return end;local b,f,g,o=f(3,"Sl"),g.upper,n.hls,g.hl;local b=m(b.short_src,25)..":"..b.currentline;local i,m=i(...),"[%-6s%s] %s: "local d,p=d("%H:%M:%S"),d()local b,d=c(m,f,d,b),c(m,f,p,b)local f={}for a in i:gmatch("([^\n]*)\n?")do if a~=""then f[#f+1]=a end end;if n.clog then if g and o then h(c("echohl %s",o))end;for d,d in j(f)do h(c([[echom "[%s] %s"]],a,l(b..d,'"')))end;if g and o then h("echohl NONE")end end;if n.ufle and#f>0 then local a=e(k,"a")if a then for b,b in j(f)do a:write(d..b.."\n")end;a:close()end end end;for a,d in j(n.mod)do b[d.name]=function(...)g(a,d,p,...)end;b["fmt_"..d.name]=function(...)g(a,d,function(a,...)local b={}for a,a in j({...})do b[#b+1]=i(a)end;return c(a,unpack(b))end,...)end end;return b end;b.new(a,true)return b

